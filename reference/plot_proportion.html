<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Plot proportions of factor levels (y axis) by bins (x axis) — plot_proportion • nwfscSurvey</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot proportions of factor levels (y axis) by bins (x axis) — plot_proportion"><meta name="description" content="Bin a numerical column for the categorical x axis. Calculate the proportion
of the rows that are present for each level of an additional factor column,
like sex, by x-axis bins."><meta property="og:description" content="Bin a numerical column for the categorical x axis. Calculate the proportion
of the rows that are present for each level of an additional factor column,
like sex, by x-axis bins."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">nwfscSurvey</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/nwfscSurvey.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Plot proportions of factor levels (y axis) by bins (x axis)</h1>

      <div class="d-none name"><code>plot_proportion.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Bin a numerical column for the categorical x axis. Calculate the proportion
of the rows that are present for each level of an additional factor column,
like sex, by x-axis bins.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plot_proportion</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">column_factor</span>,</span>
<span>  <span class="va">column_bin</span>,</span>
<span>  digits <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  bar_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"n"</span>, <span class="st">"equal"</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A data frame.</p></dd>


<dt id="arg-column-factor">column_factor<a class="anchor" aria-label="anchor" href="#arg-column-factor"></a></dt>
<dd><p>&lt;<code>data-masking</code>&gt; Variable in
<code>data</code> for the grouping structure. Should be a variable in <code>data</code> that
contains a factor but it can also be a variable in <code>data</code> that stores
characters. See the examples for ideas.</p></dd>


<dt id="arg-column-bin">column_bin<a class="anchor" aria-label="anchor" href="#arg-column-bin"></a></dt>
<dd><p>&lt;<code>data-masking</code>&gt; Variable in <code>data</code>
for the binning structure. If this is not already a factor or character,
then <code><a href="https://ggplot2.tidyverse.org/reference/cut_interval.html" class="external-link">ggplot2::cut_width()</a></code> will be used to create bins. The bins are saved
in <code>bin</code> in the returned ggplot2 object.</p></dd>


<dt id="arg-digits">digits<a class="anchor" aria-label="anchor" href="#arg-digits"></a></dt>
<dd><p>A numeric value passed to the digits argument of <code><a href="https://rdrr.io/r/base/Round.html" class="external-link">round()</a></code>.
Positive values pertain to rounding the right side of the decimal place and
negative values pertain to rounding the left side of the decimal place,
i.e., to the tens or hundreds with -1 and -2. The default is to round to
the nearest integer using <code>digits = 0</code>.</p></dd>


<dt id="arg-bar-width">bar_width<a class="anchor" aria-label="anchor" href="#arg-bar-width"></a></dt>
<dd><p>A string of <code>"n"</code> or <code>"equal"</code>, where the former leads to
bar widths based on the number of observations contained in that group and
the latter leads to equally-sized bars for all bars with data. For groups
without any data, the width of the placeholder on the x axis will be
smaller than the width of the bars for groups with data regardless of which
option you choose. The default is to have bars of variable widths, i.e.,
<code>"n"</code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments that users want to pass to
<code><a href="https://ggplot2.tidyverse.org/reference/cut_interval.html" class="external-link">ggplot2::cut_width()</a></code>. If <code>data[[column_bin]]</code> is not a factor, then at
least <code>width</code> needs to be passed to create bins. But, any argument accepted
by <code><a href="https://ggplot2.tidyverse.org/reference/cut_interval.html" class="external-link">ggplot2::cut_width()</a></code> can be passed, where <code>boundary = 0</code> is common so
the calculation of bins will start at zero rather than the minimum value
present, preventing bins like (35.4, 36.4] when you really want (35, 36].</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A ggplot2 object created with ggmosaic features.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><a href="https://haleyjeppson.github.io/ggmosaic/" class="external-link">ggmosaic</a> is used to
create a ggplot2 object for categorical data that can be modified upon
return.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index">
<ul><li><p><code><a href="https://ggplot2.tidyverse.org/reference/cut_interval.html" class="external-link">ggplot2::cut_width()</a></code></p></li>
<li><p><code><a href="https://haleyjeppson.github.io/ggmosaic/reference/geom_mosaic.html" class="external-link">ggmosaic::geom_mosaic()</a></code></p></li>
<li><p><code><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor()</a></code></p></li>
</ul></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Ian G. Taylor, Chantel R. Wetzel, Kelli F. Johnson</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Add presence/absence factor to data</span></span></span>
<span class="r-in"><span><span class="va">temp</span> <span class="op">&lt;-</span> <span class="va">catch_nwfsc_combo</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>new <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">cpue_kg_km2</span> <span class="op">&lt;=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>    levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="cn">TRUE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Present"</span>, <span class="st">"Absent"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot depth bins (50 m) by presence/absence with default colors</span></span></span>
<span class="r-in"><span><span class="fu">plot_proportion</span><span class="op">(</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">temp</span>,</span></span>
<span class="r-in"><span>  column_factor <span class="op">=</span> <span class="va">new</span>,</span></span>
<span class="r-in"><span>  column_bin <span class="op">=</span> <span class="va">Depth_m</span>,</span></span>
<span class="r-in"><span>  width <span class="op">=</span> <span class="fl">50</span>,</span></span>
<span class="r-in"><span>  boundary <span class="op">=</span> <span class="fl">0</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_proportion-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># Plot latitude bins (1 decimal degree) by presence/absence with custom</span></span></span>
<span class="r-in"><span><span class="co"># colors</span></span></span>
<span class="r-in"><span><span class="fu">plot_proportion</span><span class="op">(</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">temp</span>,</span></span>
<span class="r-in"><span>  column_factor <span class="op">=</span> <span class="va">new</span>,</span></span>
<span class="r-in"><span>  column_bin <span class="op">=</span> <span class="va">Latitude_dd</span>,</span></span>
<span class="r-in"><span>  width <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>  boundary <span class="op">=</span> <span class="fl">0</span></span></span>
<span class="r-in"><span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"darkorchid3"</span>,</span></span>
<span class="r-in"><span>    <span class="fu">grDevices</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grDevices/gray.html" class="external-link">gray</a></span><span class="op">(</span><span class="fl">0.7</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Scale for <span style="color: #00BB00;">fill</span> is already present.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Adding another scale for <span style="color: #00BB00;">fill</span>, which will replace the existing scale.</span>
<span class="r-plt img"><img src="plot_proportion-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># Plot depth bins (25 m) by sex (F, M, U)</span></span></span>
<span class="r-in"><span><span class="fu">plot_proportion</span><span class="op">(</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">bio_nwfsc_combo</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Sex <span class="op">=</span> <span class="fu"><a href="codify_sex.html">codify_sex</a></span><span class="op">(</span><span class="va">Sex</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  column_factor <span class="op">=</span> <span class="va">Sex</span>,</span></span>
<span class="r-in"><span>  column_bin <span class="op">=</span> <span class="va">Depth_m</span>,</span></span>
<span class="r-in"><span>  width <span class="op">=</span> <span class="fl">25</span>,</span></span>
<span class="r-in"><span>  boundary <span class="op">=</span> <span class="fl">0</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following unmatched values were found n times in `codify_sex()`:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 'NA' (n = 1)</span>
<span class="r-plt img"><img src="plot_proportion-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># Change to equal sized bars</span></span></span>
<span class="r-in"><span><span class="fu">plot_proportion</span><span class="op">(</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">bio_nwfsc_combo</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Sex <span class="op">=</span> <span class="fu"><a href="codify_sex.html">codify_sex</a></span><span class="op">(</span><span class="va">Sex</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  column_factor <span class="op">=</span> <span class="va">Sex</span>,</span></span>
<span class="r-in"><span>  column_bin <span class="op">=</span> <span class="va">Depth_m</span>,</span></span>
<span class="r-in"><span>  width <span class="op">=</span> <span class="fl">25</span>,</span></span>
<span class="r-in"><span>  boundary <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>  bar_width <span class="op">=</span> <span class="st">"equal"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following unmatched values were found n times in `codify_sex()`:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 'NA' (n = 1)</span>
<span class="r-plt img"><img src="plot_proportion-4.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Chantel R. Wetzel, Kelli F. Johnson, Allan C. Hicks.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

